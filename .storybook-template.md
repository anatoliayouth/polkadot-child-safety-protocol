# Storybook Component Documentation

This file documents the key UI components and their usage patterns.

## CreateChildForm

Form component for creating new child profiles.

**Props:**
- `onSuccess?: (childId: string) => void` - Callback when child is created
- `onError?: (error: string) => void` - Callback when creation fails

**Fields:**
- `name` (required): Child's name
- `did` (optional): Decentralized Identifier

**Example:**
```tsx
import { CreateChildForm } from '@components/CreateChildForm';

export function MyComponent() {
  return (
    <CreateChildForm
      onSuccess={(childId) => console.log('Created:', childId)}
      onError={(error) => console.error(error)}
    />
  );
}
```

## AddGuardianForm

Form component for adding guardians to a child profile.

**Props:**
- `childId` (required): ID of the child
- `onSuccess?: () => void` - Callback when guardian is added
- `onError?: (error: string) => void` - Callback when addition fails

**Fields:**
- `address` (required): Blockchain wallet address
- `name` (required): Guardian's name
- `email` (optional): Email address
- `permissionLevel` (required): 'admin' | 'moderator' | 'viewer'

**Example:**
```tsx
import { AddGuardianForm } from '@components/AddGuardianForm';

export function MyComponent() {
  return (
    <AddGuardianForm
      childId="child-123"
      onSuccess={() => console.log('Guardian added')}
      onError={(error) => console.error(error)}
    />
  );
}
```

## ChildIdentityOverview

Displays child profile information and credential status.

**Props:**
- `child` (required): Child object

**Displays:**
- Child name
- DID (Decentralized Identifier)
- Credential status (active, pending, revoked)
- Creation and update dates

**Example:**
```tsx
import { ChildIdentityOverview } from '@components/ChildIdentityOverview';

const child = {
  id: 'child-1',
  name: 'Alice',
  did: 'did:kilt:...',
  credentialStatus: 'active',
  createdAt: new Date(),
  updatedAt: new Date(),
};

export function MyComponent() {
  return <ChildIdentityOverview child={child} />;
}
```

## GuardianManagement

Lists guardians for a child and allows removal.

**Props:**
- `childId` (required): ID of the child
- `onError?: (error: string) => void` - Error callback

**Features:**
- Displays guardians in a table
- Shows permission levels
- Remove button for each guardian
- Confirmation dialog before removal

**Example:**
```tsx
import { GuardianManagement } from '@components/GuardianManagement';

export function MyComponent() {
  return (
    <GuardianManagement
      childId="child-123"
      onError={(error) => console.error(error)}
    />
  );
}
```

## ActivityLog

Displays activity feed with timeline visualization.

**Props:**
- `childId?: string` - Optional filter by child
- `maxItems?: number` - Maximum items to display (default: 10)
- `onError?: (error: string) => void` - Error callback

**Features:**
- Timeline visualization
- Activity type icons
- Actor information
- Timestamps
- Supports multiple activity types

**Example:**
```tsx
import { ActivityLog } from '@components/ActivityLog';

export function MyComponent() {
  return (
    <ActivityLog
      childId="child-123"
      maxItems={20}
      onError={(error) => console.error(error)}
    />
  );
}
```

## NotificationFeed

Real-time notification display with SSE integration.

**Features:**
- Auto-dismisses after 5 seconds
- Manual dismiss button
- Clear all notifications
- Slide-in animation
- Accessible with ARIA attributes

**Example:**
```tsx
import { NotificationFeed } from '@components/NotificationFeed';

export function MyComponent() {
  return (
    <div>
      <NotificationFeed />
      {/* Rest of your app */}
    </div>
  );
}
```

## FormInput

Reusable text input component with validation.

**Props:**
- `label` (required): Input label
- `name` (required): Input name
- `type?: string` - HTML input type (default: 'text')
- `value` (required): Current value
- `error?: string` - Error message
- `touched?: boolean` - Whether field has been interacted with
- `onChange` (required): Change handler
- `onBlur` (required): Blur handler
- `placeholder?: string` - Placeholder text
- `required?: boolean` - Mark as required
- `disabled?: boolean` - Disable input

**Example:**
```tsx
import { FormInput } from '@components/FormInput';

export function MyComponent() {
  const [value, setValue] = useState('');
  const [error, setError] = useState('');
  const [touched, setTouched] = useState(false);

  return (
    <FormInput
      label="Name"
      name="name"
      value={value}
      error={error}
      touched={touched}
      onChange={(e) => setValue(e.target.value)}
      onBlur={() => setTouched(true)}
      required
    />
  );
}
```

## FormSelect

Reusable select input component with validation.

**Props:**
- `label` (required): Select label
- `name` (required): Select name
- `value` (required): Current value
- `options` (required): Array of { value, label } objects
- `error?: string` - Error message
- `touched?: boolean` - Whether field has been interacted with
- `onChange` (required): Change handler
- `onBlur` (required): Blur handler
- `required?: boolean` - Mark as required
- `disabled?: boolean` - Disable select

**Example:**
```tsx
import { FormSelect } from '@components/FormSelect';

export function MyComponent() {
  const [value, setValue] = useState('viewer');

  return (
    <FormSelect
      label="Permission Level"
      name="permission"
      value={value}
      options={[
        { value: 'admin', label: 'Admin' },
        { value: 'moderator', label: 'Moderator' },
        { value: 'viewer', label: 'Viewer' },
      ]}
      onChange={(e) => setValue(e.target.value)}
      onBlur={() => {}}
      required
    />
  );
}
```

## GuardianDashboard

Main dashboard component that orchestrates all sub-components.

**Features:**
- Child profile selector
- Create child form
- Guardian management interface
- Activity feed
- Real-time notifications

**Example:**
```tsx
import { GuardianDashboard } from '@components/GuardianDashboard';

export function App() {
  return <GuardianDashboard />;
}
```

## Styling

All components use CSS classes defined in `src/styles/global.css`. Key class names:

- `.card` - Card container
- `.form-input` / `.form-select` - Form elements
- `.btn` / `.btn--primary` / `.btn--danger` - Buttons
- `.alert--success` / `.alert--error` - Alert messages
- `.status` / `.status--active` - Status badges
- `.badge` / `.badge--admin` - Permission badges
- `.table` - Table styling
- `.timeline` - Activity timeline

### CSS Variables

Customize the UI by overriding CSS variables:

```css
:root {
  --color-primary: #5a67d8;
  --color-danger: #f56565;
  --spacing-lg: 1.5rem;
  --font-family-base: '...';
}
```

## Testing

Each component has corresponding test files in `__tests__/` directories:

```
CreateChildForm.test.tsx
AddGuardianForm.test.tsx
ChildIdentityOverview.test.tsx
GuardianManagement.test.tsx
ActivityLog.test.tsx
NotificationFeed.test.tsx
```

Run tests:
```bash
npm test
```

## Accessibility

All components follow accessibility best practices:

- Proper label associations with `htmlFor`
- ARIA attributes for validation states
- Semantic HTML structure
- Keyboard navigation support
- Focus management
- Error announcements

## Performance Tips

1. Memoize callbacks passed to form components
2. Use the `childId` prop to filter data at the API level
3. Implement pagination for large activity logs
4. Debounce API calls in search fields
5. Lazy load NotificationFeed for better initial load time
